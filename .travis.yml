sudo: false
dist: trusty
language: ruby
cache: bundler
before_install:
- bundle -v
- rm Gemfile.lock || true
- gem update --system
- gem update bundler
- gem --version
- bundle -v
script:
- bundle exec rake $CHECK
bundler_args: "--without system_tests"
rvm:
- 2.4.1
- 2.1.9
env:
- PUPPET_GEM_VERSION="~> 4.0" CHECK=spec
matrix:
  fast_finish: true
  include:
  - env: CHECK=rubocop
  - env: CHECK="syntax lint"
  - env: CHECK=metadata_lint
branches:
  only:
  - master
  - "/^v\\d/"
notifications:
  email: false
deploy:
  provider: puppetforge
  user: kogitoapp
  password:
    secure: Bu29Et11NdRMJuOplQF6eX3QIhc8/4MI//4OSZsyQ3pdpGxeec74N4pYw3Zm30R+xSR+MfEthIsCDkswVd2pjEOA1Q4mO4pnP/K99wZEfHiNNTXfkVEx0ZSlVUddLI5BCEGQaC3utrMZAKY4CjZA6DS2+BCktLpGhnFdXGQB0M484ESqRVKimbl2fD2+OsQP51kO4pp55dbLWnj4RRyw2U46a2oz0LD3JC7Z+f5Z5vhtJ0w2yOnRGuv6S8/xgQ+kX1rr7BkATpjMJ0/gaH3hS57PrTMoEqsI745ofrGwLsrS8q6+3iTdKxjLkm+fhPX5oKMxu/CmQqmYJluMBWgHf8MNdCGwFEg9p+nqv1Xp5D76QkV1u9SLemdxj8gjUwyR9lIKfFokvm6T0ulQv9jIa9YMik9P9S3y5nRIQkkOdb/mS5Q/BeZQn2wSfi//TwZu8oZWwC0S5y4Pv2l3vJtdFPWyKEibG9LDCZO6faxJWkxUs0nCnsk2EaMslPaxVHXX3Hudclj+3p6BDEewRbCAzMtdq8wIrl4cP4Pju/OoDIBGlXCCzPHDXNsGgfZV042ngNpznt4uL1N0ttlYdYyYLa76guY2FA4l79HiTa97McDFsoQcYGVTF6/BCc1ib+MPYCu6NTPnVlrIPJSDRbFPGQV3KaGVF4DGJtiHpT8qRGk=
  on:
    tags: true
    all_branches: true
    condition: "$DEPLOY_TO_FORGE = yes"
